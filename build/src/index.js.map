{"version":3,"sources":["../../server/src/index.js"],"names":["mongoDB","connection","mongoose","connect","db","on","console","error","bind","once","log","app","Port","process","env","PORT","use","bodyParser","urlencoded","extended","json","express","static","path","resolve","__dirname","webpackConfig","set","join","get","req","res","sendfile","post","url","decodeURIComponent","query","search","response","body","title","isbn","description","coverages","coverage","data","$","cheerio","load","content","Array","from","forEach","journal","index","children","next","find","each","i","cite","name","push","link","firstChild","attribs","text","send","render","listen"],"mappings":"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","file":"index.js","sourcesContent":["import express from 'express';\nimport path from 'path';\nimport Crawler from \"crawler\";\nimport request from \"request\";\nimport cheerio from \"cheerio\";\nimport bodyParser from 'body-parser';\nimport webpack from 'webpack';\nimport webpackMiddleware from 'webpack-dev-middleware';\nimport webpackConfig from '../../webpack.config';\n// import { scrapeRoute } from './route/index';\nimport pug from 'pug';\nimport mongoose from 'mongoose';\n\nconst mongoDB = 'mongodb://root:Acc355c0d3@ds261929.mlab.com:61929/algorithmanalysis';\n// database connection\nconst connection = mongoose.connect(mongoDB);\n \nlet db = mongoose.connection;\ndb.on('error', console.error.bind(console, 'connection error:'));\ndb.once('open', function() {\n  // we're connected!\n  console.log('connected')\n});\n\n// starting app\nconst app = express();\n\nconst Port = process.env.PORT || 5000;\n// console.log(process.env)\n\n// parse application/x-www-form-urlencoded\napp.use(bodyParser.urlencoded({\n  extended: false\n}))\n\n// // parse application/json\napp.use(bodyParser.json())\n\n// load static files=============\napp.use(express.static(path.resolve(__dirname, '../../client/public')));\n \n// =============================\napp.use(webpackMiddleware(webpack(webpackConfig)));\n// =======================================\n\napp.set('view engine', 'pug');\napp.set(\"views\", path.join(__dirname, \"views\"));\n\n\napp.get('/', (req, res) => {\n  res.sendfile(path.resolve(__dirname, '../../client/public/index.html'));\n});\n\napp.get('/contact', (req, res) => {\n  res.sendfile(path.resolve(__dirname, '../../client/public/index.html'));\n});\n\n/**\n * start scrapper\n */\n\n\napp.post('/search', (req, res) => {\n  // console.log(req.query)\n  let url = decodeURIComponent(req.query.search);\n  // console.log(url)\n\n  request(url, function (error, response, body) {\n    let title, isbn, description, coverages, coverage;\n    coverages = [];\n    coverage = [];\n    let data = [];\n\n    if (!error) {\n      let $ = cheerio.load(body)\n\n      let content = Array.from($('#results > form > ul > li'));\n      content.forEach((journal, index) => {\n        title = journal.children[0].children[0].data;\n        isbn = journal.children[1].data;\n        description = journal.children[1].next.next.data;\n        // \n        $(journal).find(\"div > ul\").each((i, cite) => {\n          coverage = [];\n          cite.children.forEach(name => {\n            if (name.name === 'li') {\n              // console.log(name.firstChild.attribs)\n              coverage.push({\n                link: (name.firstChild.attribs),\n                text: name.firstChild.children[0].data\n              });\n\n\n            }\n          });\n\n        })\n        //  coverage.push(coverages);\n        data.push({\n          title,\n          isbn,\n          description,\n          coverage\n        });\n\n      })\n\n      res.send(data);\n    } else {\n      console.log(\"Weâ€™ve encountered an error: \" + error);\n    }\n  });\n});\n\n\napp.get('/scienceweb', (req, res) => res.render('index'));\n\napp.get('/login', (req, res) => res.render('login') );\napp.get('/scienceweb/pricing', (req, res) => res.render('pricing'));\napp.get('/scienceweb/institution-signup/:price', (req, res) => res.render('register'));\napp.get('/scienceweb/payment_summary', (req, res) => res.render('payment_summary'));\napp.get('/scienceweb/searchResult', (req, res) => res.render('search_result'));\napp.get('/scienceweb/search/:articleTitle', (req, res) => res.render('search_details'));\napp.get('/scienceweb/addArticle', (req, res) => res.render('addarticle'));\napp.get('/scienceweb/articles', (req, res) => res.render('articles'));\n\n\napp.listen(Port, (req, res) => console.log('server started http://localhost:' + Port));"]}